<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129083106-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-129083106-2');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>养棵植物吧</title>

  <!-- Bootstrap -->
   <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
   <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
   <link rel="stylesheet" type="text/css"  href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">



   <link rel="stylesheet" href="css/font-awesome.min.css">
   <link href="css/animate.min.css" rel="stylesheet">
   <link href="css/prettyPhoto.css" rel="stylesheet">
   <link href="css/style.css" rel="stylesheet">
   <link href="css/responsive.css" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/leaflet.css">
   <link rel="shortcut icon" href="">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/leaflet.js"></script>
   <script src="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
</head>

<body class="homepage">
  <header id="header">
    <nav class="navbar navbar-fixed-top" role="banner">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">导航栏</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
          <a class="navbar-brand" href="howtobuy.html">养棵植物</a>
        </div>

        <div class="collapse navbar-collapse navbar-right">
          <ul class="nav navbar-nav">
            <li><a href="howtobuy.html">买什么花</a></li>
            <li><a href="howtogrow.html">花怎么养</a></li>
            <li><a href="howtoput.html">花怎么摆</a></li>
            <li class="active"><a href="wheretobuy.html">去哪里买</a></li>
            <li><a href="contactme.html">给我留言</a></li>
          </ul>
        </div>
      </div>
      <!--/.container-->
    </nav>
    <!--/nav-->

  </header>
  <!--/header-->
  <section id="about-us">
    <div class="container">
      <div class="skill-wrap clearfix">
        <div class="center wow fadeInDown">

        <h2>哪里可以买到？</h2>
        <p class="lead">这里收录了上海较为出名的花木市场，点击下方的按钮即可显示 <br> 在一个阳光明媚的双休日去买一盆植物吧</p>

        <div id="play" style="text-align:center; padding: 25px">
        <button type="button" class="btn btn-success" style="background-color:#6D8188;text-align:center" id='roll_up' onclick="show_districts();">点击查看花鸟市场</button><br>

      </div>
    </div>




        <div class="container">
        <div id="map" style="width: 800px; height: 440px; border: 1px solid #AAA; margin-left: auto;margin-right: auto;"></div>

        <script>
            var mapboxTiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: 'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a>', maxZoom: 18,})
            var map = L.map('map')
                  .addLayer(mapboxTiles)
                  .setView([31.305351, 121.435724], 10);
            var items = [];
            var airtable_read_endpoint = "https://api.airtable.com/v0/appLoT6UQEuKYLDsF/Flowershop?api_key=keyBadmTVmE3SwXQR";
            var data = [];
            $.getJSON(airtable_read_endpoint, function(result) {
                   $.each(result.records, function(key,value) {
                       items = {};
                           items["name"] = value.fields.Flowershop;
                           items["Flowershop_Images"] = value.fields.F_Images;
                           items["Latitude"] = value.fields.Latitude;
                           items["Longitude"] = value.fields.Longitude;
                          items["address"] = value.fields.address;
                           data.push(items);
                           console.log(items);
                    }); // end .each
            }); // end getJSON
        </script>
        <script>
        function show_districts(){
          for (var i in data) {
              var latlng = L.latLng({ lat: data[i].Latitude, lng: data[i].Longitude});

              var myIcon = L.icon({
                  iconUrl: 'flower2.png',
                  iconSize: [28, 28],
                  iconAnchor: [22, 94],
                  popupAnchor: [-3, -76],
              });

              L.marker( latlng, {icon: myIcon})
                  .bindPopup('<a><img src="' + data[i].Flowershop_Images+'" width = "80px"><br>' + '</a>' + data[i].name)
                  .addTo(map);
          }
        }
        </script>
      </div>


  <!--/#portfolio-item-->




        <div class="container" >
          <div class="get-started center wow fadeInDown">
            <h2>上海部分花木市场</h2>

            <div id="app">

                        <ul style="list-style-type: none;
                        margin: 0;
                        padding: 0;
                        display: flex;
                        justify-content: center;
                        flex-wrap: wrap;">
                            <li v-for="item in items" style="  width: 370px;
                              background: #e6eaec;
                              border-radius: 15px;
                              padding: 15px;
                              margin: 30px;">
                                <h3  style="text-align: center;"><strong>{{ item['fields']['Flowershop'] }}</strong></h3>
                                    <p style="text-align: left"><strong>地址：</strong>{{ item['fields']['address'] }}</p>
                                    <p style="text-align: left"><strong>简介：</strong>{{ item['fields']['Discription'] }}</p>

                            </li>
                        </ul1>
                    </div><!--app-->

                    <!-- Include Dependancy Scripts -->
                            <script type="text/javascript" src="https://unpkg.com/vue"></script>
                            <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.2/axios.min.js"></script>
                    <script type="text/javascript">
                                var app = new Vue({
                                    el: '#app',
                                    data: {
                                        items: []
                                    },
                                    mounted: function(){
                                       this.loadItems();
                                    },
                                    methods: {
                                        loadItems: function(){

                                            // Init variables
                                            var self = this
                                            var app_id = "appLoT6UQEuKYLDsF";
                                            var app_key = "keyBadmTVmE3SwXQR";
                                            this.items = []
                    axios.get(
                                                "https://api.airtable.com/v0/"+app_id+"/Flowershop?view=Grid%20view",
                                                {
                                                    headers: { Authorization: "Bearer "+app_key }
                                                }
                                            ).then(function(response){
                                                self.items = response.data.records
                                            }).catch(function(error){
                                                console.log(error)
                                            })
                                        }
                                    }
                                })
                            </script>

        </div>
      </div>
    </div>
      </section>







  <div class="top-bar" >
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="social">
            <ul class="social-share">
              <li><a href="#"><i class="fab fa-weixin"></i></a></li>
              <li><a href="#"><i class="fab fa-weibo"></i></a></li>
              <li><a href="#"><i class="fas fa-envelope-open"></i></a></li>
              <li><a href="#"><i class="fab fa-instagram"></i></a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!--/.container-->
  </div>
  <!--/.top-bar-->

  <footer id="footer" class="midnight-blue">
    <div class="container">
      <div class="row">
        <div class="col-sm-6"style="color:white">
          感谢您光顾本网站，希望它能帮助到您<br>本网站由薛徐婷（Xue Xuting）制作
          </div>
        </div>

      </div>
    </div>
  </footer>
  <!--/#footer-->

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->

  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.prettyPhoto.js"></script>
  <script src="js/jquery.isotope.min.js"></script>
  <script src="js/wow.min.js"></script>
  <script src="js/main.js"></script>

</body>

</html>
